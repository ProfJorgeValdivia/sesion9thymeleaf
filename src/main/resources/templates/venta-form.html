<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Venta</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
          rel="stylesheet">
</head>
<body>

<div class="container mt-4">

    <div class="card shadow">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0"
                th:text="${venta.id == null ? 'Registrar Venta' : 'Editar Venta'}">
            </h4>
        </div>

        <div class="card-body">

			<form th:action="@{/ventas/guardar}"
			      th:object="${venta}"
			      method="post"
			      class="container mt-4">

				  <!-- Cliente -->
			      <div class="mb-3">
			          <label class="form-label">Cliente</label>
			          <input type="text" th:field="*{cliente}" class="form-control" required>
			      </div>

			      <!-- Usuario -->
			      <div class="mb-3">
			          <label class="form-label">Usuario</label>
			          <select th:field="*{usuario.id}" class="form-select" required>
			              <option value="">Seleccione</option>
			              <option th:each="u : ${usuarios}"
			                      th:value="${u.id}"
			                      th:text="${u.nombre}">
			              </option>
			          </select>
			      </div>
				  <!-- DETALLES -->
				      <h5>Detalles</h5>

				      <div th:each="d, stat : *{detalles}">
				          <div class="row mb-2">
				              <div class="col">
				                  <input type="text"
				                         th:field="*{detalles[__${stat.index}__].producto}"
				                         class="form-control"
				                         placeholder="Producto">
				              </div>
				              <div class="col">
				                  <input type="number"
				                         th:field="*{detalles[__${stat.index}__].cantidad}"
				                         class="form-control"
				                         placeholder="Cantidad">
				              </div>
				              <div class="col">
				                  <input type="number"
				                         step="0.01"
				                         th:field="*{detalles[__${stat.index}__].precio}"
				                         class="form-control"
				                         placeholder="Precio">
				              </div>
				          </div>
				      </div>
                <div class="d-flex justify-content-end gap-2">
                    <a th:href="@{/ventas}" class="btn btn-secondary">
                        Cancelar
                    </a>
                    <button type="submit" class="btn btn-success">
                        Guardar
                    </button>
                </div>

            </form>

        </div>
    </div>

</div>

</body>
</html>
